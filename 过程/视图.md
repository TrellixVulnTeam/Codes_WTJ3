---
title: 视图
author: Alex Ma
---

# 用户模块

## 登录

[用户登录与注册系统4（表单)](https://www.cnblogs.com/jinyuanliu/p/10534017.html)

[使用表单 | Django 文档 | Django (djangoproject.com)](https://docs.djangoproject.com/zh-hans/3.2/topics/forms/)

* [x] user_login

方法：POST

涉及Employee

表单 login_form:

| name        | type    |      |
| ----------- | ------- | ---- |
| employee_id | Integer |      |
| password    | Char    |      |







## 登出

[session会话](https://www.cnblogs.com/jinyuanliu/p/10539541.html)

* [x] user_logout



## 注册

[Django实战(一)-----用户登录与注册系统6（session会话、注册视图） - jayonlau - 博客园 (cnblogs.com)](https://www.cnblogs.com/jinyuanliu/p/10539541.html)

* [x] user_register

方法：POST

涉及 Employee

使用 session

表单 register_form:

| name        | type    |      |
| ----------- | ------- | ---- |
| name        | Char    |      |
| employee_id | Integer |      |
| password1   | Char    |      |
| password2   | Char    |      |
| department  | Char    |      |
| position    | Choice  |      |



## 邮件确认



# 管理员模块

## 管理账户信息

涉及 Employee, Balance_account, turnover 表

* [x] add_one_employee
* [x] show_employee
* [x] change_one_employee



* [x] add_one_account
  * [x] balance 初始为0
* [x] show_account
* [x] change_one_account
  * [x] 若更改了balance，则增加一条流水turnover

## 管理餐厅信息

涉及 

* [ ] 


## 管理可选送餐地址

涉及 Location 表

* [x] add_one_location
* [x] show_location
* [x] change_one_location



# 餐厅员工模块

## 修改菜单

涉及 Menu 表

* [x] add_dish
* [x] show_dish
* [x] change_one_dish

## **接受备餐订单**

* [x] accept_dish_order
  * [x] 修改Menu
    * [x] stock
    * [x] 不修改 order_status

## **请求送餐**

* [x] request_delivery
  * [x] 修改 Order
    * [x] status 完成备餐
    * [x] meal_complete_time
  * [x] 若 eat_in_store 
    * [x] **堂食**：status 完成送达
    * [x] **送出**：以备餐完成的状态 等待delivery

# 企业员工模块

## 查看菜单 和 今日特价

涉及Menu

* [x] show_dish



## 订餐 - 预定状态，订单开始

涉及 **Order,** **order_menu**, Menu, Balance_account, turnover表

* [x] order_dish
  * [x] 先创建order_id
  * [x] 订单开始
  * [x] 根据输入的dish_name查表Menu找到价格 **生成order_menu记录**
  * [x] 还未支付，都是默认选项，以此 **生成Order记录**（先生成，因为order_menu引用Order）
  * [x] Order中
    * [x] 各种时间(除了build_time)，payment_id，r_delivery_id暂时未生成

## 支付 - 完成支付

涉及Order，Balance_account, turnover表

* [x] pay
  * [x] 修改 **Order** 的
    * [x] pay_method 若为余额支付：
      * [x] 增加**turnover记录**
      * [x] 有 payment_id 
    * [x] payment_time
    * [x] status 完成支付
  * [x] 修改 **Balance_account**
    * [x] balance

## 查看订单情况

涉及 Order

* [x] show_order



## 投诉

* [x] complain

方法 POST

涉及 Complaint

表单complain_form：

| name     | type     |                      |
| -------- | -------- | -------------------- |
| order_id | Interger |                      |
| type     | Choice   | r_staff / r_delivery |
| content  | Text     |                      |
| feedback | Text     |                      |
|          |          |                      |



## 查看流水

* [x] show_turnovers

涉及 turnover

方法GET



# 送餐员模块

## 接受送餐订单

涉及Order

* [x] accept_delivery_order
  * [x] 修改Order 
    * [x] order_status为 完成接单
    * [x] accept_order_time
    * [x] r_delivery_id



## 送达

* [x] delivered
  * [x] 修改Order
    * [x] order_status 完成送达
    * [x] delivery_time

# 餐厅经理模块

## 查看菜单

## 管理菜单

## 数据统计

## 查看投诉

